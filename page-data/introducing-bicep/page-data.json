{"componentChunkName":"component---src-templates-post-template-js","path":"/introducing-bicep/","result":{"data":{"post":{"id":"f7844adf-5ee5-5d1e-9c7a-b52c377e4b01","html":"<p>Lots of folks use <a href=\"https://docs.microsoft.com/en-us/azure/azure-resource-manager/\">Azure Resource Manager (ARM) templates</a> to define their Azure resources, and tooling like the <a href=\"https://docs.microsoft.com/en-us/cli/azure/reference-index?view=azure-cli-latest\">Az CLI</a> or <a href=\"https://docs.microsoft.com/en-us/powershell/azure/?view=azps-5.5.0\">Az PowerShell</a> to deploy them. I’ve talked about these before in a <a href=\"/azure-for-automators\">previous post</a>.</p>\n<p>Microsoft have long acknowledged that ARM has its weaknesses; it’s verbose, constructs like loops and conditions and functions are awkward to use, and it can be difficult to know if you’ve got the <code class=\"language-text\">dependsOn</code> elements right.</p>\n<p>Enter <a href=\"https://github.com/Azure/bicep\">Bicep</a>.</p>\n<p>This post won’t be another getting started guide to Bicep. You can follow the Bicep teams own getting started guide and tutorials at your own pace for that. Rather, in this post we’ll deconstruct a real Bicep template that I built recently for an Azure Function app.</p>\n<p>But first some introductions.</p>\n<h1>What is Bicep?</h1>\n<p>Bicep is a new Domain Specific Language (DSL) for writing declarative Azure deployments. It uses ARM templates as an intermediate language. That is, your Bicep files compile to ARM JSON templates which you can then deploy with existing ARM template deployment processes like <a href=\"https://docs.microsoft.com/en-us/powershell/module/az.resources/new-azresourcegroupdeployment?view=azps-5.5.0\"><code class=\"language-text\">New-AzResourceGroupDeployment</code></a>, <a href=\"https://docs.microsoft.com/en-us/cli/azure/deployment?view=azure-cli-latest\"><code class=\"language-text\">az deployment</code></a>, the <a href=\"https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/deploy-portal#deploy-resources-from-custom-template\">Azure Portal</a>, <a href=\"https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/deploy/azure-resource-group-deployment?view=azure-devops\">Azure DevOps Pipeline tasks</a>, <a href=\"https://github.com/marketplace/actions/deploy-azure-resource-manager-arm-template\">Github Actions</a>, etc.</p>\n<p>The Bicep team have written a good introduction to the what and why of Bicep on the <a href=\"https://github.com/Azure/bicep/blob/main/README.md\">project readme</a>.</p>\n<p>The project readme also has a list of the goals and non-goals of the project which do a good job of setting expectations around what Bicep is and is not. You can see them on the readme, but to summarise;</p>\n<ul>\n<li>\n<p>Goals</p>\n<ul>\n<li>To be a strict superset of ARM that’s easier to work with. Anything you can do with ARM you should be able to do with Bicep, and do it more easily.</li>\n<li>It should be easier to understand and have a shallower learning curve than ARM.</li>\n<li>You should be able to use all the same concepts you use for building ARM templates, but apply them more easily.</li>\n<li>Excellent tooling that provides resource and type discoverability and validation, built alongside the compiler and not bolted on at the end.</li>\n</ul>\n</li>\n<li>\n<p>Non-Goals (quoting directly from the readme)</p>\n<ul>\n<li>“Build a general purpose language to meet any need. This will not replace general purpose languages and you may still need to do pre or post Bicep tasks in a script or high-level programming language.”</li>\n<li>“Provide a first-class provider model for non-Azure related tasks. While we will likely introduce an extensibility model at some point, any extension points are intended to be focused on Azure infra or application deployment related tasks.”</li>\n</ul>\n</li>\n</ul>\n<h1>It’s still early days</h1>\n<p>Before going any further, I should point out that as of early 2021, Bicep is still an <strong>experimental</strong> language. It’s still very early days for the language, tooling, and resource provider support. The latest version as I write this post is <a href=\"https://github.com/Azure/bicep/releases/tag/v0.2.328\">0.2.328</a>.</p>\n<p>This means a few things;</p>\n<ul>\n<li>Bicep is not yet at feature parity with ARM. There’s things you can do in ARM that you can’t do in Bicep. The list of major known limitations is on the <a href=\"https://github.com/Azure/bicep#known-limitations\">readme</a>. That list is much shorter now that it was when Bicep was first announced at Build 2020 and demo’d at <a href=\"https://devblogs.microsoft.com/devops/project-bicep-demo-at-ignite-2020-by-mark-russinovich/\">Ignite 2020</a>, but it’s still not empty.</li>\n<li>The language is still evolving, you should expect breaking changes in future releases.</li>\n<li>Along with things you <em>can’t</em> do with Bicep, there’s also a number of things that, while you can do them with Bicep, it’s not as easy as the Bicep team would like it to be. Expect new language syntax to be introduced to cover those things.</li>\n</ul>\n<p>In short, Bicep is neither officially supported nor production ready. It has a lot of potential and the team are hard at work making it better (just look at the <a href=\"https://github.com/Azure/bicep/issues\">issue log</a>!), but the current advice is to;</p>\n<p><em>Use Bicep at your own risk.</em></p>\n<h1>Installing Bicep</h1>\n<p>To get going, see the <a href=\"https://github.com/Azure/bicep/blob/main/docs/installing.md\">installation documentation</a> to install the <a href=\"https://github.com/Azure/bicep/blob/main/docs/installing.md#install-the-bicep-cli\">CLI</a> and <a href=\"https://github.com/Azure/bicep/blob/main/docs/installing.md#install-the-bicep-vs-code-extension\">VS Code extension</a>.</p>\n<p>You can find the latest releases on the project’s GitHub <a href=\"https://github.com/Azure/bicep/releases/latest\">Releases page</a>.</p>\n<p>For Windows users, the CLI package is also available on Winget (<code class=\"language-text\">winget install bicep</code>) and Chocolatey (<code class=\"language-text\">choco install bicep</code>) if that’s your thing.</p>\n<h1>Using Bicep</h1>\n<p>At this stage in Bicep’s life, there isn’t any special support for Bicep in the Az CLI or Az PowerShell. You have to use the Bicep compiler to generate the ARM json templates, which you then deploy.</p>\n<p>Do this with <code class=\"language-text\">bicep build</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">bicep build deploy.bicep</code></pre></div>\n<p>When you <code class=\"language-text\">build</code> a <code class=\"language-text\">.bicep</code> file, it’ll generate an ARM template named <code class=\"language-text\">{bicep filename}.json</code>, in this case <code class=\"language-text\">deploy.bicep</code> generates <code class=\"language-text\">deploy.json</code>.</p>\n<h1>Let’s see the code!</h1>\n<p>In this post we’ll deconstruct an existing Bicep template I wrote for an Azure Function app. You can find the <code class=\"language-text\">deploy.bicep</code> template <a href=\"https://github.com/tonesandtones/link-redirector/blob/238a142577e72070010eb6643726bc8b94899b69/deploy/deploy.bicep\">in context on GitHub</a>.</p>\n<p><div id=\"gist108127042\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-deploy-bicep\" class=\"file my-2\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-text  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-deploy-bicep-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-deploy-bicep-LC1\" class=\"blob-code blob-code-inner js-file-line\">// See the original in context at https://github.com/tonesandtones/link-redirector/blob/238a142577e72070010eb6643726bc8b94899b69/deploy/deploy.bicep</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-deploy-bicep-LC2\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-deploy-bicep-LC3\" class=\"blob-code blob-code-inner js-file-line\">param location string = resourceGroup().location</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-deploy-bicep-LC4\" class=\"blob-code blob-code-inner js-file-line\">param appBaseName string = &#39;linky&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-deploy-bicep-LC5\" class=\"blob-code blob-code-inner js-file-line\">param environmentSuffix string {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-deploy-bicep-LC6\" class=\"blob-code blob-code-inner js-file-line\">  default: &#39;dev&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-deploy-bicep-LC7\" class=\"blob-code blob-code-inner js-file-line\">  allowed: [</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-deploy-bicep-LC8\" class=\"blob-code blob-code-inner js-file-line\">    &#39;dev&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-deploy-bicep-LC9\" class=\"blob-code blob-code-inner js-file-line\">    &#39;prod&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-deploy-bicep-LC10\" class=\"blob-code blob-code-inner js-file-line\">  ]</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-deploy-bicep-LC11\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-deploy-bicep-LC12\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-deploy-bicep-LC13\" class=\"blob-code blob-code-inner js-file-line\">param storageSku string {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-deploy-bicep-LC14\" class=\"blob-code blob-code-inner js-file-line\">  default: &#39;Standard_LRS&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-deploy-bicep-LC15\" class=\"blob-code blob-code-inner js-file-line\">  allowed:[</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-deploy-bicep-LC16\" class=\"blob-code blob-code-inner js-file-line\">    &#39;Standard_LRS&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-deploy-bicep-LC17\" class=\"blob-code blob-code-inner js-file-line\">  ]</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-deploy-bicep-LC18\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-deploy-bicep-LC19\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-deploy-bicep-LC20\" class=\"blob-code blob-code-inner js-file-line\">param tableNameAka string = &#39;Aka&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-deploy-bicep-LC21\" class=\"blob-code blob-code-inner js-file-line\">param tableNameStats string = &#39;stats&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-deploy-bicep-LC22\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-deploy-bicep-LC23\" class=\"blob-code blob-code-inner js-file-line\">param functionRuntime string = &#39;dotnet&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-deploy-bicep-LC24\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-deploy-bicep-LC25\" class=\"blob-code blob-code-inner js-file-line\">param XAuthSecretResource string</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-deploy-bicep-LC26\" class=\"blob-code blob-code-inner js-file-line\">param AppInsightsApiKeySecretResource string</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-deploy-bicep-LC27\" class=\"blob-code blob-code-inner js-file-line\">param keyVaultName string = &#39;default&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-deploy-bicep-LC28\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-deploy-bicep-LC29\" class=\"blob-code blob-code-inner js-file-line\">var storageName = toLower(&#39;${appBaseName}${environmentSuffix}${uniqueString(resourceGroup().id)}&#39;)</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-deploy-bicep-LC30\" class=\"blob-code blob-code-inner js-file-line\">var functionAppName = &#39;${appBaseName}-${environmentSuffix}-app&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-deploy-bicep-LC31\" class=\"blob-code blob-code-inner js-file-line\">var appServiceName = &#39;${appBaseName}-${environmentSuffix}-asp&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-deploy-bicep-LC32\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-deploy-bicep-LC33\" class=\"blob-code blob-code-inner js-file-line\">//only used to reference a resource, not create one. See declaration in keyvault.bicep</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-deploy-bicep-LC34\" class=\"blob-code blob-code-inner js-file-line\">var appInsightsName = &#39;${appBaseName}-${environmentSuffix}-appinsights&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-deploy-bicep-LC35\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-deploy-bicep-LC36\" class=\"blob-code blob-code-inner js-file-line\">//default name format is defined in keyvault.bicep</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-deploy-bicep-LC37\" class=\"blob-code blob-code-inner js-file-line\">var computedKeyVaultName = keyVaultName == &#39;default&#39; ? &#39;${appBaseName}-${environmentSuffix}-kv&#39; : &#39;default&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-deploy-bicep-LC38\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-deploy-bicep-LC39\" class=\"blob-code blob-code-inner js-file-line\">resource stg &#39;Microsoft.Storage/storageAccounts@2019-06-01&#39; = {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-deploy-bicep-LC40\" class=\"blob-code blob-code-inner js-file-line\">  name: storageName</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-deploy-bicep-LC41\" class=\"blob-code blob-code-inner js-file-line\">  location: location</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-deploy-bicep-LC42\" class=\"blob-code blob-code-inner js-file-line\">  kind: &#39;StorageV2&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"></td>\n        <td id=\"file-deploy-bicep-LC43\" class=\"blob-code blob-code-inner js-file-line\">  sku: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-deploy-bicep-LC44\" class=\"blob-code blob-code-inner js-file-line\">      name: storageSku</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-deploy-bicep-LC45\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-deploy-bicep-LC46\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-deploy-bicep-LC47\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-deploy-bicep-LC48\" class=\"blob-code blob-code-inner js-file-line\">resource tableAka &#39;Microsoft.Storage/storageAccounts/tableServices/tables@2019-06-01&#39; = {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-deploy-bicep-LC49\" class=\"blob-code blob-code-inner js-file-line\">  name: &#39;${stg.name}/default/${tableNameAka}&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-deploy-bicep-LC50\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-deploy-bicep-LC51\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-deploy-bicep-LC52\" class=\"blob-code blob-code-inner js-file-line\">resource tableStats &#39;Microsoft.Storage/storageAccounts/tableServices/tables@2019-06-01&#39; = {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-deploy-bicep-LC53\" class=\"blob-code blob-code-inner js-file-line\">  name: &#39;${stg.name}/default/${tableNameStats}&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-deploy-bicep-LC54\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-deploy-bicep-LC55\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"></td>\n        <td id=\"file-deploy-bicep-LC56\" class=\"blob-code blob-code-inner js-file-line\">resource appService &#39;Microsoft.Web/serverFarms@2020-06-01&#39; = {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L57\" class=\"blob-num js-line-number\" data-line-number=\"57\"></td>\n        <td id=\"file-deploy-bicep-LC57\" class=\"blob-code blob-code-inner js-file-line\">  name: appServiceName</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L58\" class=\"blob-num js-line-number\" data-line-number=\"58\"></td>\n        <td id=\"file-deploy-bicep-LC58\" class=\"blob-code blob-code-inner js-file-line\">  location: location</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L59\" class=\"blob-num js-line-number\" data-line-number=\"59\"></td>\n        <td id=\"file-deploy-bicep-LC59\" class=\"blob-code blob-code-inner js-file-line\">  kind: &#39;functionapp&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L60\" class=\"blob-num js-line-number\" data-line-number=\"60\"></td>\n        <td id=\"file-deploy-bicep-LC60\" class=\"blob-code blob-code-inner js-file-line\">  sku: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L61\" class=\"blob-num js-line-number\" data-line-number=\"61\"></td>\n        <td id=\"file-deploy-bicep-LC61\" class=\"blob-code blob-code-inner js-file-line\">    name: &#39;Y1&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L62\" class=\"blob-num js-line-number\" data-line-number=\"62\"></td>\n        <td id=\"file-deploy-bicep-LC62\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L63\" class=\"blob-num js-line-number\" data-line-number=\"63\"></td>\n        <td id=\"file-deploy-bicep-LC63\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L64\" class=\"blob-num js-line-number\" data-line-number=\"64\"></td>\n        <td id=\"file-deploy-bicep-LC64\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L65\" class=\"blob-num js-line-number\" data-line-number=\"65\"></td>\n        <td id=\"file-deploy-bicep-LC65\" class=\"blob-code blob-code-inner js-file-line\">resource functionApp &#39;Microsoft.Web/sites@2020-06-01&#39; = {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L66\" class=\"blob-num js-line-number\" data-line-number=\"66\"></td>\n        <td id=\"file-deploy-bicep-LC66\" class=\"blob-code blob-code-inner js-file-line\">  name: functionAppName</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L67\" class=\"blob-num js-line-number\" data-line-number=\"67\"></td>\n        <td id=\"file-deploy-bicep-LC67\" class=\"blob-code blob-code-inner js-file-line\">  kind: &#39;functionapp&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L68\" class=\"blob-num js-line-number\" data-line-number=\"68\"></td>\n        <td id=\"file-deploy-bicep-LC68\" class=\"blob-code blob-code-inner js-file-line\">  location: location</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L69\" class=\"blob-num js-line-number\" data-line-number=\"69\"></td>\n        <td id=\"file-deploy-bicep-LC69\" class=\"blob-code blob-code-inner js-file-line\">  identity: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L70\" class=\"blob-num js-line-number\" data-line-number=\"70\"></td>\n        <td id=\"file-deploy-bicep-LC70\" class=\"blob-code blob-code-inner js-file-line\">    type: &#39;SystemAssigned&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L71\" class=\"blob-num js-line-number\" data-line-number=\"71\"></td>\n        <td id=\"file-deploy-bicep-LC71\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L72\" class=\"blob-num js-line-number\" data-line-number=\"72\"></td>\n        <td id=\"file-deploy-bicep-LC72\" class=\"blob-code blob-code-inner js-file-line\">  properties: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L73\" class=\"blob-num js-line-number\" data-line-number=\"73\"></td>\n        <td id=\"file-deploy-bicep-LC73\" class=\"blob-code blob-code-inner js-file-line\">    serverFarmId: appService.id</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L74\" class=\"blob-num js-line-number\" data-line-number=\"74\"></td>\n        <td id=\"file-deploy-bicep-LC74\" class=\"blob-code blob-code-inner js-file-line\">    httpsOnly: true</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L75\" class=\"blob-num js-line-number\" data-line-number=\"75\"></td>\n        <td id=\"file-deploy-bicep-LC75\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L76\" class=\"blob-num js-line-number\" data-line-number=\"76\"></td>\n        <td id=\"file-deploy-bicep-LC76\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L77\" class=\"blob-num js-line-number\" data-line-number=\"77\"></td>\n        <td id=\"file-deploy-bicep-LC77\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L78\" class=\"blob-num js-line-number\" data-line-number=\"78\"></td>\n        <td id=\"file-deploy-bicep-LC78\" class=\"blob-code blob-code-inner js-file-line\">resource functionAppAppSettings &#39;Microsoft.Web/sites/config@2020-06-01&#39; = {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L79\" class=\"blob-num js-line-number\" data-line-number=\"79\"></td>\n        <td id=\"file-deploy-bicep-LC79\" class=\"blob-code blob-code-inner js-file-line\">  name: &#39;${functionApp.name}/appsettings&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L80\" class=\"blob-num js-line-number\" data-line-number=\"80\"></td>\n        <td id=\"file-deploy-bicep-LC80\" class=\"blob-code blob-code-inner js-file-line\">  properties:{</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L81\" class=\"blob-num js-line-number\" data-line-number=\"81\"></td>\n        <td id=\"file-deploy-bicep-LC81\" class=\"blob-code blob-code-inner js-file-line\">    AzureWebJobsStorage: &#39;DefaultEndpointsProtocol=https;AccountName=${stg.name};EndpointSuffix=${environment().suffixes.storage};AccountKey=${listKeys(stg.id, stg.apiVersion).keys[0].value}&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L82\" class=\"blob-num js-line-number\" data-line-number=\"82\"></td>\n        <td id=\"file-deploy-bicep-LC82\" class=\"blob-code blob-code-inner js-file-line\">    WEBSITE_CONTENTAZUREFILECONNECTIONSTRING: &#39;DefaultEndpointsProtocol=https;AccountName=${stg.name};EndpointSuffix=${environment().suffixes.storage};AccountKey=${listKeys(stg.id, stg.apiVersion).keys[0].value}&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L83\" class=\"blob-num js-line-number\" data-line-number=\"83\"></td>\n        <td id=\"file-deploy-bicep-LC83\" class=\"blob-code blob-code-inner js-file-line\">    APPINSIGHTS_INSTRUMENTATIONKEY: reference(resourceId(&#39;Microsoft.Insights/components&#39;, appInsightsName), &#39;2020-02-02-preview&#39;).InstrumentationKey</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L84\" class=\"blob-num js-line-number\" data-line-number=\"84\"></td>\n        <td id=\"file-deploy-bicep-LC84\" class=\"blob-code blob-code-inner js-file-line\">    APPLICATIONINSIGHTS_CONNECTION_STRING: &#39;InstrumentationKey=${reference(resourceId(&#39;Microsoft.Insights/components&#39;, appInsightsName), &#39;2020-02-02-preview&#39;).InstrumentationKey}&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L85\" class=\"blob-num js-line-number\" data-line-number=\"85\"></td>\n        <td id=\"file-deploy-bicep-LC85\" class=\"blob-code blob-code-inner js-file-line\">    FUNCTIONS_WORKER_RUNTIME: functionRuntime</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L86\" class=\"blob-num js-line-number\" data-line-number=\"86\"></td>\n        <td id=\"file-deploy-bicep-LC86\" class=\"blob-code blob-code-inner js-file-line\">    FUNCTIONS_EXTENSION_VERSION: &#39;~3&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L87\" class=\"blob-num js-line-number\" data-line-number=\"87\"></td>\n        <td id=\"file-deploy-bicep-LC87\" class=\"blob-code blob-code-inner js-file-line\">    WEBSITE_RUN_FROM_PACKAGE: &#39;1&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L88\" class=\"blob-num js-line-number\" data-line-number=\"88\"></td>\n        <td id=\"file-deploy-bicep-LC88\" class=\"blob-code blob-code-inner js-file-line\">    &#39;X-Authorization&#39;: &#39;@Microsoft.KeyVault(SecretUri=${XAuthSecretResource})&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L89\" class=\"blob-num js-line-number\" data-line-number=\"89\"></td>\n        <td id=\"file-deploy-bicep-LC89\" class=\"blob-code blob-code-inner js-file-line\">    AppInsightsApiKey: &#39;@Microsoft.KeyVault(SecretUri=${AppInsightsApiKeySecretResource})&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L90\" class=\"blob-num js-line-number\" data-line-number=\"90\"></td>\n        <td id=\"file-deploy-bicep-LC90\" class=\"blob-code blob-code-inner js-file-line\">    AppInsightsAppId: reference(resourceId(&#39;Microsoft.Insights/components&#39;, appInsightsName), &#39;2020-02-02-preview&#39;).AppId</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L91\" class=\"blob-num js-line-number\" data-line-number=\"91\"></td>\n        <td id=\"file-deploy-bicep-LC91\" class=\"blob-code blob-code-inner js-file-line\">    &#39;AzureWebJobs.StatsCollector.Disabled&#39;: &#39;true&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L92\" class=\"blob-num js-line-number\" data-line-number=\"92\"></td>\n        <td id=\"file-deploy-bicep-LC92\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L93\" class=\"blob-num js-line-number\" data-line-number=\"93\"></td>\n        <td id=\"file-deploy-bicep-LC93\" class=\"blob-code blob-code-inner js-file-line\">  dependsOn:[</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L94\" class=\"blob-num js-line-number\" data-line-number=\"94\"></td>\n        <td id=\"file-deploy-bicep-LC94\" class=\"blob-code blob-code-inner js-file-line\">    keyVaultAccessPolicies</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L95\" class=\"blob-num js-line-number\" data-line-number=\"95\"></td>\n        <td id=\"file-deploy-bicep-LC95\" class=\"blob-code blob-code-inner js-file-line\">  ]</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L96\" class=\"blob-num js-line-number\" data-line-number=\"96\"></td>\n        <td id=\"file-deploy-bicep-LC96\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L97\" class=\"blob-num js-line-number\" data-line-number=\"97\"></td>\n        <td id=\"file-deploy-bicep-LC97\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L98\" class=\"blob-num js-line-number\" data-line-number=\"98\"></td>\n        <td id=\"file-deploy-bicep-LC98\" class=\"blob-code blob-code-inner js-file-line\">resource keyVaultAccessPolicies &#39;Microsoft.KeyVault/vaults/accessPolicies@2019-09-01&#39; = {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L99\" class=\"blob-num js-line-number\" data-line-number=\"99\"></td>\n        <td id=\"file-deploy-bicep-LC99\" class=\"blob-code blob-code-inner js-file-line\">  name: any(&#39;${keyVaultName}/add&#39;)</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L100\" class=\"blob-num js-line-number\" data-line-number=\"100\"></td>\n        <td id=\"file-deploy-bicep-LC100\" class=\"blob-code blob-code-inner js-file-line\">  properties: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L101\" class=\"blob-num js-line-number\" data-line-number=\"101\"></td>\n        <td id=\"file-deploy-bicep-LC101\" class=\"blob-code blob-code-inner js-file-line\">    accessPolicies: [</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L102\" class=\"blob-num js-line-number\" data-line-number=\"102\"></td>\n        <td id=\"file-deploy-bicep-LC102\" class=\"blob-code blob-code-inner js-file-line\">      {</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L103\" class=\"blob-num js-line-number\" data-line-number=\"103\"></td>\n        <td id=\"file-deploy-bicep-LC103\" class=\"blob-code blob-code-inner js-file-line\">        tenantId: functionApp.identity.tenantId</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L104\" class=\"blob-num js-line-number\" data-line-number=\"104\"></td>\n        <td id=\"file-deploy-bicep-LC104\" class=\"blob-code blob-code-inner js-file-line\">        objectId: functionApp.identity.principalId</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L105\" class=\"blob-num js-line-number\" data-line-number=\"105\"></td>\n        <td id=\"file-deploy-bicep-LC105\" class=\"blob-code blob-code-inner js-file-line\">        permissions:{</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L106\" class=\"blob-num js-line-number\" data-line-number=\"106\"></td>\n        <td id=\"file-deploy-bicep-LC106\" class=\"blob-code blob-code-inner js-file-line\">          secrets: [</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L107\" class=\"blob-num js-line-number\" data-line-number=\"107\"></td>\n        <td id=\"file-deploy-bicep-LC107\" class=\"blob-code blob-code-inner js-file-line\">            &#39;get&#39;</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L108\" class=\"blob-num js-line-number\" data-line-number=\"108\"></td>\n        <td id=\"file-deploy-bicep-LC108\" class=\"blob-code blob-code-inner js-file-line\">          ]</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L109\" class=\"blob-num js-line-number\" data-line-number=\"109\"></td>\n        <td id=\"file-deploy-bicep-LC109\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L110\" class=\"blob-num js-line-number\" data-line-number=\"110\"></td>\n        <td id=\"file-deploy-bicep-LC110\" class=\"blob-code blob-code-inner js-file-line\">      }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L111\" class=\"blob-num js-line-number\" data-line-number=\"111\"></td>\n        <td id=\"file-deploy-bicep-LC111\" class=\"blob-code blob-code-inner js-file-line\">    ]</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L112\" class=\"blob-num js-line-number\" data-line-number=\"112\"></td>\n        <td id=\"file-deploy-bicep-LC112\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L113\" class=\"blob-num js-line-number\" data-line-number=\"113\"></td>\n        <td id=\"file-deploy-bicep-LC113\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L114\" class=\"blob-num js-line-number\" data-line-number=\"114\"></td>\n        <td id=\"file-deploy-bicep-LC114\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L115\" class=\"blob-num js-line-number\" data-line-number=\"115\"></td>\n        <td id=\"file-deploy-bicep-LC115\" class=\"blob-code blob-code-inner js-file-line\">output storageId string = stg.id</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L116\" class=\"blob-num js-line-number\" data-line-number=\"116\"></td>\n        <td id=\"file-deploy-bicep-LC116\" class=\"blob-code blob-code-inner js-file-line\">output computedStorageName string = stg.name</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L117\" class=\"blob-num js-line-number\" data-line-number=\"117\"></td>\n        <td id=\"file-deploy-bicep-LC117\" class=\"blob-code blob-code-inner js-file-line\">output computedAkaTableName string = tableNameAka</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L118\" class=\"blob-num js-line-number\" data-line-number=\"118\"></td>\n        <td id=\"file-deploy-bicep-LC118\" class=\"blob-code blob-code-inner js-file-line\">output computedStatsTableName string = tableNameStats</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L119\" class=\"blob-num js-line-number\" data-line-number=\"119\"></td>\n        <td id=\"file-deploy-bicep-LC119\" class=\"blob-code blob-code-inner js-file-line\">output functionAppHostName string = functionApp.properties.defaultHostName</td>\n      </tr>\n      <tr>\n        <td id=\"file-deploy-bicep-L120\" class=\"blob-num js-line-number\" data-line-number=\"120\"></td>\n        <td id=\"file-deploy-bicep-LC120\" class=\"blob-code blob-code-inner js-file-line\">output computedFunctionAppName string = functionAppName</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/tonesandtones/a359669bb9a1f34e833b04826ae69ba4/raw/e3051bc9dd1ca9be6988cf027b1ed643377e8c2e/deploy.bicep\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/tonesandtones/a359669bb9a1f34e833b04826ae69ba4#file-deploy-bicep\">deploy.bicep</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h2>Parameters</h2>\n<p>Bicep parameters have two forms, there’s a short syntax that only lets you define the name, type, and default value, and a longer form that lets you do all the other things you can do with ARM parameters.</p>\n<p>A parameter with no default value can look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">param AppInsightsApiKeySecretResource string</code></pre></div>\n<p>When compiled to ARM with <code class=\"language-text\">bicep build</code>, it looks like a simple bare-bones <code class=\"language-text\">parameter</code> declaration:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"parameters\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n   ...\n  <span class=\"token property\">\"AppInsightsApiKeySecretResource\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To add a default value, add <code class=\"language-text\">= {default value}</code>, like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">param location string = resourceGroup().location</code></pre></div>\n<p>This turns into a basic parameter with a default value. When you <code class=\"language-text\">bicep build</code>, this parameter turns into the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"parameters\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  ...\n  <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"defaultValue\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[resourceGroup().location]\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You’ll notice that ARM functions are supported too, just like in ARM templates. All the regular functions are supported in the same way as ARM, and with all the same restrictions.</p>\n<p>Bicep supports <code class=\"language-text\">&quot;allowedValues&quot;</code>, although you need to use the long form I mentioned earlier. Here’s a parameter with 2 allowed values.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">param environmentSuffix string {\n  default: &#39;dev&#39;\n  allowed: [\n    &#39;dev&#39;\n    &#39;prod&#39;\n  ]\n}</code></pre></div>\n<p>becomes</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"parameters\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  ...\n  <span class=\"token property\">\"environmentSuffix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"defaultValue\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dev\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"allowedValues\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"dev\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"prod\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You use similar syntax to define other constraints and properties too. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">param environmentSuffix string {\n  default: &#39;dev&#39;\n  metadata:{\n    description: &#39;The environment suffix&#39;\n  }\n  minLength: 3\n  maxLength: 20\n}</code></pre></div>\n<p>becomes</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"parameters\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  ...\n  <span class=\"token property\">\"environmentSuffix\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"minLength\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"maxLength\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"metadata\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"The environment suffix\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"defaultValue\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dev\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Variables</h2>\n<p>Bicep variables have a similar syntax to the ‘simple’ form of the parameter, although without needing to specify a type. The next few examples show using existing ARM functions, but also introduce some of the new Bicep language syntax.</p>\n<p>Here we see Bicep’s support for string interpolation, and a couple of additional ARM functions.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">var appInsightsName = &#39;${appBaseName}-${environmentSuffix}-appinsights&#39;\nvar storageName = toLower(&#39;${appBaseName}${environmentSuffix}${uniqueString(resourceGroup().id)}&#39;)</code></pre></div>\n<p>These two variables <code class=\"language-text\">appInsightsName</code> and <code class=\"language-text\">storageName</code> become</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"variables\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  ...\n  <span class=\"token property\">\"appInsightsName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[format('{0}-{1}-appinsights', parameters('appBaseName'), parameters('environmentSuffix'))]\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"storageName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[toLower(format('{0}{1}{2}', parameters('appBaseName'), parameters('environmentSuffix'), uniqueString(resourceGroup().id)))]\"</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You’ll see that Bicep uses the <code class=\"language-text\">format()</code> string function rather than <code class=\"language-text\">concat()</code>.</p>\n<p>Next up, we see Bicep’s support for ternary if-then-else expressions.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">var computedKeyVaultName = keyVaultName == &#39;default&#39; ? &#39;${appBaseName}-${environmentSuffix}-kv&#39; : &#39;default&#39;</code></pre></div>\n<p> becomes</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"variables\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  ...\n<span class=\"token property\">\"computedKeyVaultName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[if(equals(parameters('keyVaultName'), 'default'), format('{0}-{1}-kv', parameters('appBaseName'), parameters('environmentSuffix')), 'default')]\"</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Resources</h2>\n<p>Resources in Bicep look a bit different to ARM, and is where we start to see Bicep really shine. Let’s take a look at the Storage account.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">resource stg &#39;Microsoft.Storage/storageAccounts@2019-06-01&#39; = {\n  name: storageName\n  location: location\n  kind: &#39;StorageV2&#39;\n  sku: {\n      name: storageSku\n  }\n}\n\nresource tableAka &#39;Microsoft.Storage/storageAccounts/tableServices/tables@2019-06-01&#39; = {\n  name: &#39;${stg.name}/default/${tableNameAka}&#39;\n}</code></pre></div>\n<p>As you might expect from reading the Bicep for these two resources, they become:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"resources\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  ...\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Microsoft.Storage/storageAccounts\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"apiVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2019-06-01\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[variables('storageName')]\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[parameters('location')]\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"kind\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"StorageV2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sku\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[parameters('storageSku')]\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Microsoft.Storage/storageAccounts/tableServices/tables\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"apiVersion\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2019-06-01\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[format('{0}/default/{1}', variables('storageName'), parameters('tableNameAka'))]\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"dependsOn\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"[resourceId('Microsoft.Storage/storageAccounts', variables('storageName'))]\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>There’s a lot going on here, so let’s break it down a bit. A resource in Bicep is defined by the following syntax;</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">resource &lt;identifier&gt; &#39;&lt;resource provider namespace&gt;@&lt;version&gt;&#39;= {\n  ...&lt;properties&gt;...\n}</code></pre></div>\n<p>The <code class=\"language-text\">&lt;identifier&gt;</code> is a special Bicep construct, it doesn’t appear in the final ARM template. It lets us refer to the resource elsewhere in the Bicep file. We see this used in the <code class=\"language-text\">.../tableServices/tables</code> resource that defines a storage table. It’s what allows Bicep to know that when we say <code class=\"language-text\">${stg.name}</code>, it needs to generate a <code class=\"language-text\">&quot;dependsOn&quot;: [ &quot;[resourceId(&#39;Microsoft.Storage/storageAccounts&#39;, variables(&#39;storageName&#39;))]&quot; ]</code> property.</p>\n<p>The properties that go inside the braces are the same properties you would define in an ARM template, so use the existing ARM resource provider <a href=\"https://docs.microsoft.com/en-us/azure/templates/\">documentation</a> to know what they are.</p>\n<p>We also see Bicep’s automatic <code class=\"language-text\">dependsOn</code> support showing up in some of the other resources. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">resource functionApp &#39;Microsoft.Web/sites@2020-06-01&#39; = {\n  name: functionAppName\n  kind: &#39;functionapp&#39;\n  location: location\n  identity: {\n    type: &#39;SystemAssigned&#39;\n  }\n  properties: {\n    serverFarmId: appService.id      // &lt;----- references another resource\n    httpsOnly: true\n  }\n}</code></pre></div>\n<p>Notice the line that says <code class=\"language-text\">serviceFarmId: appService.Id</code>? That becomes a <code class=\"language-text\">&quot;[resourceId(...)]&quot;</code> function, and generates another <code class=\"language-text\">&quot;dependsOn&quot;</code> property:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Microsoft.Web/sites\"</span><span class=\"token punctuation\">,</span>\n  ...snip for brevity...\n  <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"serverFarmId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"[resourceId('Microsoft.Web/serverfarms', variables('appServiceName'))]\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"httpsOnly\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependsOn\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"[resourceId('Microsoft.Web/serverfarms', variables('appServiceName'))]\"</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Let’s take a look at the Function App’s app settings resource, there’s some interesting syntax going in there:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">resource functionAppAppSettings &#39;Microsoft.Web/sites/config@2020-06-01&#39; = {\n  name: &#39;${functionApp.name}/appsettings&#39;\n  properties:{\n    // snip for brevity\n    // Also... yay comments!\n    WEBSITE_RUN_FROM_PACKAGE: &#39;1&#39;\n    &#39;X-Authorization&#39;: &#39;@Microsoft.KeyVault(SecretUri=${XAuthSecretResource})&#39;\n    AppInsightsApiKey: &#39;@Microsoft.KeyVault(SecretUri=${AppInsightsApiKeySecretResource})&#39;\n    AppInsightsAppId: reference(resourceId(&#39;Microsoft.Insights/components&#39;, appInsightsName), &#39;2020-02-02-preview&#39;).AppId\n    &#39;AzureWebJobs.StatsCollector.Disabled&#39;: &#39;true&#39;\n  }\n  dependsOn:[\n    keyVaultAccessPolicies\n  ]\n}</code></pre></div>\n<p>A couple of things to point out here:</p>\n<ul>\n<li>\n<p>You can add explicit <code class=\"language-text\">dependsOn</code> if either a) Bicep doesn’t correctly generate the <code class=\"language-text\">&quot;dependsOn&quot;</code> entry, or b) it’s an implicit dependency that Bicep (or even ARM) has no way to know about.</p>\n<ul>\n<li>In this case, the <code class=\"language-text\">appSettings</code> resource includes some <a href=\"https://docs.microsoft.com/en-us/azure/app-service/app-service-key-vault-references\">App Service Key Vault references</a>, and we want to make sure the <code class=\"language-text\">keyVaultAccessPolicies</code> resource is deployed first, to make sure the right access policies are in place so the App Service can retrieve the secrets as soon as it starts up.</li>\n</ul>\n</li>\n<li>\n<p>There’s a few ARM resource types that allow arbitrary property names, App Service app settings are one of them. Anything that’s a valid JSON string can be used as the property name. But Bicep has rules governing the naming of properties that are more strict that those of JSON and ARM, so Bicep supports single-quote-escaping property names that wouldn’t otherwise be valid Bicep identifiers.</p>\n<ul>\n<li>We see this here with <code class=\"language-text\">&#39;X-Authorization&#39;</code> and <code class=\"language-text\">&#39;AzureWebJobs.StatsCollector.Disabled&#39;</code>. Neither of those are valid Bicep property names, so we have to escape them with single quotes.</li>\n</ul>\n</li>\n<li>Bicep also allows <code class=\"language-text\">// comments</code>! Yay!</li>\n</ul>\n<p>Like the ARM VS Code extension, both the Bicep VS Code extension <em>and</em> the Bicep CLI are type aware. This allows the VS Code extension to tell you what properties you can and must include, and the CLI will emit warning or error messages if you’re missing required properties, or if the types don’t match, etc.</p>\n<p>But Bicep’s type support doesn’t always get things right. So here’s one last resource example showing how to break free of Bicep’s type system when it gets things wrong.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">resource keyVaultAccessPolicies &#39;Microsoft.KeyVault/vaults/accessPolicies@2019-09-01&#39; = {\n  name: any(&#39;${keyVaultName}/add&#39;)\n  properties: {\n    accessPolicies: [\n      {\n        tenantId: functionApp.identity.tenantId\n        objectId: functionApp.identity.principalId\n        permissions:{\n          secrets: [\n            &#39;get&#39;\n          ]\n        }\n      }\n    ]\n  }\n}</code></pre></div>\n<p>In this case, Bicep’s type support thinks the only valid values for the <code class=\"language-text\">name</code> of a <code class=\"language-text\">Microsoft.KeyVault/vaults/accessPolicies</code> is one of <code class=\"language-text\">add</code>, <code class=\"language-text\">replace</code>, or <code class=\"language-text\">remove</code>. In this case, because we’re deploying a child resource we also need to include the name of the parent resource, following ARMs usual <a href=\"https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/child-resource-name-type\">child resource naming rules</a>.</p>\n<p>The special Bicep <code class=\"language-text\">any()</code> function let’s us tell Bicep to ignore its type constraints and allows us to put define any value, effectively suppressing Bicep’s type safety.</p>\n<p>If we remove the <code class=\"language-text\">any()</code> function here, Bicep would emit an error and refuse to compile the <code class=\"language-text\">.bicep</code> file</p>\n<h2>Outputs</h2>\n<p>Naturally Bicep allows us to define output values. These are exactly the same as ARM outputs, and use syntax similar to variables.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">output computedStatsTableName string = tableNameStats\noutput functionAppHostName string = functionApp.properties.defaultHostName</code></pre></div>\n<p>Notice that unlike variables we have to specify the type, in this case they’re both <code class=\"language-text\">string</code>‘s.</p>\n<p>These two <code class=\"language-text\">output</code> declarations become:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&quot;outputs&quot;: {\n  ...\n  &quot;computedStatsTableName&quot;: {\n    &quot;type&quot;: &quot;string&quot;,\n    &quot;value&quot;: &quot;[parameters(&#39;tableNameStats&#39;)]&quot;\n  },\n  &quot;functionAppHostName&quot;: {\n    &quot;type&quot;: &quot;string&quot;,\n    &quot;value&quot;: &quot;[reference(resourceId(&#39;Microsoft.Web/sites&#39;, variables(&#39;functionAppName&#39;))).defaultHostName]&quot;\n  },\n  ...\n}</code></pre></div>\n<h1>Type safety and errors</h1>\n<p>We’ve seen some of the type safety features the Bicep introduces, and introduced the <code class=\"language-text\">any()</code> operator that lets you break out of the type system.</p>\n<p>As an example of how the type safety system works, let’s look at what happens if I remove one of the <code class=\"language-text\">any()</code> operators.</p>\n<p>Here’s the experience in VS Code:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f6fde84fe0b24fdc8b756f9ce9856cc9/07a6a/vscode-with-error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 26.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAxElEQVQY03XPyY7DIAwGYJ6j2QZQWBLCFtIAIXR66anv/zwljObYT//BsmzJBoyT8Eh291waJjVCeBiGnwpCiBCCtfiHahNifI0BDDHCNKZnTL/xeJxnzmcOIYZwrNYpZRYhldLLIrU2JeqindsIIUAL4bfNP982v31+Hd6XCWvtNM+Mc0opY/wvhNDxQmrGchSgdExp9bsRYsYI9l3b3G5t07Rd23fdUPVfgPIbpWS/S6nV5MK8euHiZO6T85iyst9/9wG+QC/RJ+F+rgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"Type error in VS Code\"\n        title=\"\"\n        src=\"/static/f6fde84fe0b24fdc8b756f9ce9856cc9/5a190/vscode-with-error.png\"\n        srcset=\"/static/f6fde84fe0b24fdc8b756f9ce9856cc9/772e8/vscode-with-error.png 200w,\n/static/f6fde84fe0b24fdc8b756f9ce9856cc9/e17e5/vscode-with-error.png 400w,\n/static/f6fde84fe0b24fdc8b756f9ce9856cc9/5a190/vscode-with-error.png 800w,\n/static/f6fde84fe0b24fdc8b756f9ce9856cc9/07a6a/vscode-with-error.png 1095w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>And here’s the equivalent error you get from the CLI when you try to <code class=\"language-text\">bicep build</code> the file:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d039458724029a2bcdbbd0eea151e030/cd138/build-with-errors.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 17.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAzUlEQVQI1x3GwW6DIAAAUC5LV4EOUAFBQBS1Fq12jdllya77i5n0//9htsk7PDCN/Xq/fs6d6X7c8qiWP3/b3LLZeateqW6P9LvLft9ZwAQhShElO4jRAcT2eO2PYwvn7m1qwO7in4YKRA+CAVMAnh80gUYkuoBGvRSwthDEJhma5Ozh0KDY4kvAQ4Nri2tzCu7kNO49tgopibREiiMtULmTTyDKdNViLNK15Hedr4Z/lWLmcsxFn+WBZVMuIueSfDjGNCGKEstoQUlJ6T+zLRue/rpGhQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\"\n        alt=\"Type error in CLI\"\n        title=\"\"\n        src=\"/static/d039458724029a2bcdbbd0eea151e030/5a190/build-with-errors.png\"\n        srcset=\"/static/d039458724029a2bcdbbd0eea151e030/772e8/build-with-errors.png 200w,\n/static/d039458724029a2bcdbbd0eea151e030/e17e5/build-with-errors.png 400w,\n/static/d039458724029a2bcdbbd0eea151e030/5a190/build-with-errors.png 800w,\n/static/d039458724029a2bcdbbd0eea151e030/c1b63/build-with-errors.png 1200w,\n/static/d039458724029a2bcdbbd0eea151e030/cd138/build-with-errors.png 1220w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>The CLI output also shows a couple of warnings, saying that it doesn’t have any type information for the API version of the resource providers we’re using. You’d see the same warnings in VS Code when you work an ARM json file with the official ARM extension.</p>\n<p>One last thing to discuss about Bicep’s type system:</p>\n<ul>\n<li>The type information is only as good as what the Bicep team can generate from the API specifications for each resource provider. If you’ve worked with ARM templates long enough, you’ll know that occasionally even those API specifications are themselves wrong. You’ll need the <code class=\"language-text\">any()</code> function to get around those problems.</li>\n<li>Even when the API specifications are correct, Bicep doesn’t always apply the rules quite correctly. We saw this above with the <code class=\"language-text\">name</code> property on the Key Vault access policy resource, where we had to use the <code class=\"language-text\">any()</code> function to be able to include the parent resource name.</li>\n<li>The Bicep team are tracking known occurrences of type mismatches on GitHub issue <a href=\"https://github.com/Azure/bicep/issues/784\">#784 - Missing type validation / inaccuracies</a>. If you come across any places where you need to use the <code class=\"language-text\">any()</code> function, check the issue and if you’ve found a new one, add it to the list.</li>\n</ul>\n<h1>Conclusion</h1>\n<p>That’s a long post, congratulations on making it to the end!</p>\n<p>In this post we’ve introduced Bicep and seen how it’s a DSL that essentially uses ARM json as an intermediate language for defining and deploying Azure resources. We’ve dissected a real <code class=\"language-text\">.bicep</code> file and seen some of what makes Bicep such a compelling addition to the Azure deployment story.</p>\n<p>We’ve seen that Bicep is type-safe based on the published Azure Resource Provider specifications, and has a bunch of really useful language constructs that make it easier than ever to define your Azure infrastructure.</p>\n<p>If you have any investment in ARM templates, take Bicep for a spin. I think you’ll like it!</p>\n<h1>Resources</h1>\n<ul>\n<li><a href=\"https://github.com/Azure/bicep/\">Bicep Project</a></li>\n<li><a href=\"https://github.com/Azure/bicep/releases\">Releases</a></li>\n<li><a href=\"https://github.com/Azure/bicep/blob/main/docs/installing.md\">Installing Bicep</a> and <a href=\"https://github.com/Azure/bicep/blob/main/docs/tutorial/01-simple-template.md\">Tutorial</a></li>\n<li>GitHub issue <a href=\"https://github.com/Azure/bicep/issues/784\">#784 - Missing type validation / inaccuracies</a></li>\n<li>The <a href=\"https://github.com/tonesandtones/link-redirector/blob/238a142577e72070010eb6643726bc8b94899b69/deploy/deploy.bicep\">deploy.bicep</a> file we dissected.</li>\n<li>Cover image from this <a href=\"https://devblogs.microsoft.com/devops/project-bicep-next-generation-arm-templates/\">post by Abel Wang</a></li>\n</ul>","fields":{"slug":"/introducing-bicep/","prefix":"2021-02-25"},"frontmatter":{"title":"A gentle introduction to Bicep","author":"Anthony Attwood","category":"azure","cover":{"childImageSharp":{"resize":{"src":"/static/ae41af192cd78d93ed1aaa4c2f6f64df/630fb/abel-wang-bicep-logo.png"}}}}},"authornote":{"id":"6d7e2776-f5bf-5717-9502-2abc45ca50f5","html":"<p><strong>Anthony Attwood</strong> I’m a consultant software engineer living and working in Perth, Australia, building solutions that solve real problems for customers.</p>"}},"pageContext":{"slug":"/introducing-bicep/","prev":{"id":"5ed3a081-a2b3-587f-97cb-6fead614a564","fields":{"slug":"/key-vault-access-policies-with-arm/","prefix":"2020-08-26","source":"posts"},"frontmatter":{"title":"Azure Key Vault Access Policies with ARM","category":"azure"}},"source":"posts"}},"staticQueryHashes":["2812560700","2812560700"]}